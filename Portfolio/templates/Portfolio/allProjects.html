{% extends 'base.html' %}
{% load static %}

{% block title %}
    Projects
{% endblock %}

{% block content %}
<div class="topPage">
    <h1 style="font-family: 'RobotoSlabDark', 'sans-serif'">My Projects</h1>
</div>

<span style="text-align: center; font-family: 'RobotoSlabDark', 'sans-serif'; color: darkblue; display: block; margin: 20px 0 10px 0;">Categories:</span>
<section id="category-select">
<ul class="nav nav-pills nav-fill filter-nav justify-content-center" style="background-color:white;width: 70%; margin-left: 15%">
  <li class="nav-item">
    <a class="nav-link {% if selected_category == 'all' %}active{% endif %}" href="?category=all{% if selected_language != 'all' %}&language={{ selected_language }}{% endif %}" data-category="all">All Projects</a>
  </li>
  {% for category in categories %}
  <li class="nav-item">
    <a class="nav-link {% if selected_category == category.name %}active{% endif %}" href="?category={{ category.name }}{% if selected_language != 'all' %}&language={{ selected_language }}{% endif %}" data-category="{{ category.name }}">{{ category.name }}</a>
  </li>
  {% endfor %}
</ul>
</section>

<span style="text-align: center; font-family: 'RobotoSlabDark', 'sans-serif'; color: darkblue; display: block; margin: 20px 0 10px 0;">Programming Languages:</span>
<section id="language-select">
<ul class="nav nav-pills nav-fill filter-nav" style="background-color:white;width: 70%; margin-left: 15%">
  <li class="nav-item">
    <a class="nav-link {% if selected_language == 'all' %}active{% endif %}" href="?language=all{% if selected_category != 'all' %}&category={{ selected_category }}{% endif %}" data-language="all">All Languages</a>
  </li>
  {% for language in languages %}
  <li class="nav-item">
    <a class="nav-link {% if selected_language == language.name %}active{% endif %}" href="?language={{ language.name }}{% if selected_category != 'all' %}&category={{ selected_category }}{% endif %}" data-language="{{ language.name }}">{{ language.name }}</a>
  </li>
  {% endfor %}
</ul>
</section>

<div class="pythonTable" style="margin-bottom: -13px;">
    <div class="row gy-3">
        {% for project in projects %}
            <div class="col-12 col-sm-6 col-lg-4 mb-4 d-flex project-item">
                <div class="card h-100 w-100" style="margin:auto; ">
                    {% if project.image %}
                        <img class="card-img-top img-fluid" src="{{ project.image.url }}" alt="{{ project.title }}">
                    {% else %}
                        <img class="card-img-top img-fluid alt-img" src="{% static 'Portfolio/images/placeholderImg.jpg' %}" alt="Project placeholder image">
                    {% endif %}
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">{{ project.title }}</h5>
                        <p class="card-text">{{ project.subtitle }}</p>
                        <a href="{% url 'project-detail' project.pk %}" class="btn btn-info mt-auto">Details</a>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
</div>

<!-- Pagination -->
{% if is_paginated %}
<nav aria-label="Projects pagination">
    <ul class="pagination justify-content-center mt-4">
        {% if page_obj.has_previous %}
            <li class="page-item">
                <a class="page-link" href="?page=1&category={{ selected_category }}&language={{ selected_language }}">First</a>
            </li>
            <li class="page-item">
                <a class="page-link" href="?page={{ page_obj.previous_page_number }}&category={{ selected_category }}&language={{ selected_language }}">Previous</a>
            </li>
        {% endif %}

        <li class="page-item active">
            <span class="page-link">{{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>
        </li>

        {% if page_obj.has_next %}
            <li class="page-item">
                <a class="page-link" href="?page={{ page_obj.next_page_number }}&category={{ selected_category }}&language={{ selected_language }}">Next</a>
            </li>
            <li class="page-item">
                <a class="page-link" href="?page={{ page_obj.paginator.num_pages }}&category={{ selected_category }}&language={{ selected_language }}">Last</a>
            </li>
        {% endif %}
    </ul>
</nav>
{% endif %}

{% include 'Portfolio/includes/footer.html' %}
{% endblock %}
